<!doctype html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en"> <![endif]-->
<html class="no-js" lang="en" data-useragent="Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bolt Protocol, Version 1</title>

  <meta name="description"
        content="Bolt Protocol - a highly efficient, lightweight messaging protocol for databases"/>

  <link rel="canonical" href="https://boltprotocol.org/v1/" />

  <meta name="copyright" content="Creative Commons 3.0 Attribution-ShareAlike"/>

  <link rel="stylesheet" href="/css/foundation.css"/>
  <link rel="stylesheet" href="/css/asciidoctor.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/coderay.css"/>

  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/images/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/images/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/images/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/images/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/images/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="/images/favicon-196x196.png" sizes="196x196" />
  <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="/images/favicon-128.png" sizes="128x128" />
  <meta name="application-name" content="&nbsp;"/>
  <meta name="msapplication-TileColor" content="#FFFFFF" />
  <meta name="msapplication-TileImage" content="/images/mstile-144x144.png" />
  <meta name="msapplication-square70x70logo" content="/images/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="/images/mstile-150x150.png" />
  <meta name="msapplication-wide310x150logo" content="/images/mstile-310x150.png" />
  <meta name="msapplication-square310x310logo" content="/images/mstile-310x310.png" />

  <script src="/js/vendor/modernizr.js"></script>
  <script src="/js/toc.js"></script>
</head>
<body>

<nav class="top-bar" data-topbar>
  <ul class="title-area">
    <!-- Title Area -->
    <li class="name">
      <h1><a href="/">Bolt Protocol</a></h1>
    </li>
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="left">
      <li class="has-dropdown name">
        <h1>
          <a href="/v1/">Version 1</a>
        </h1>
        <ul class="dropdown">
          <li><a href="/v1/#overview">Overview</a></li>
          <li><a href="/v1/#transport">Transport Layer</a></li>
          <li><a href="/v1/#messaging">Messaging</a></li>
          <li><a href="/v1/#serialization">Serialization</a></li>
          <li><a href="/v1/#examples">Examples</a></li>
        </ul>
      </li>
    </ul>
    <ul class="right hide-for-small">
      <img src="/images/boltprotocol.png" style="height: 6rem;margin: 5px 5px 0 0;" />
    </ul>
  </section>
</nav>

<section role="main" class="scroll-container">
  <div class="row">
    <div class="small-12 columns" role="content">
      <h1>Bolt Protocol, Version 1</h1>
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Byte values within this document are represented in <a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal</a> notation unless otherwise specified.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Integers and floating point values are transmitted and stored using <a href="https://en.wikipedia.org/wiki/Endianness">big-endian</a> byte order unless otherwise specified.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the Bolt Protocol, version 1.</p>
</div>
<div class="paragraph">
<p>The Bolt Protocol is a client-server protocol where messages are exchanged between a client who drives an interaction and a server that processes and responds to client requests.
Every exchange of messages is initiated by the client with one or more request messages; in turn these requests are consumed by the server and corresponding response messages are returned.</p>
</div>
<div class="paragraph">
<p>The diagram below illustrates a typical interaction including the order of messages sent and the life spans of the session and job (which are described in more detail in other chapters).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/typical-interaction.png" alt="typical interaction"></span></p>
</div>
<div class="paragraph">
<p>Starting with version 1, each release of Bolt is assigned a unique, integral version number.
This number and the associated specification refers to every aspect of the protocol except for the handshake, which is unversioned.
Driver authors should note that subsequent protocol versions are likely to be incompatible and with the exception of the handshake, there is no guarantee that any transport or serialisation code can be shared across versions.</p>
</div>
<div class="paragraph">
<p>The protocol is divided into two layers&#8201;&#8212;&#8201;<a href="#transport">Bolt Transport Layer</a> and <a href="#messaging">Messaging layer</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="transport"><a class="anchor" href="#transport"></a>Bolt Transport Layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The protocol supports both regular <a href="http://en.wikipedia.org/wiki/Network_socket">socket</a> and <a href="http://en.wikipedia.org/wiki/WebSocket">WebSocket</a> transport layers for sending and receiving messages.
The transport layer is versioned along with the rest of the Bolt Protocol and is responsible for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Negotiating Bolt Protocol version</p>
</li>
<li>
<p>Establishing and terminating sessions</p>
</li>
<li>
<p>Routing messages from clients to specific sessions and back</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="sessions"><a class="anchor" href="#sessions"></a>Sessions</h3>
<div class="paragraph">
<p>Each connection to the server creates a new <strong>session</strong> that lives until that connection is closed.
Each session is isolated and the server keep track of the current state, based on the requests and responses exchanged within that session.</p>
</div>
</div>
<div class="sect2">
<h3 id="connecting"><a class="anchor" href="#connecting"></a>Connecting</h3>
<div class="paragraph">
<p>To begin a new session, the client connects using either a regular socket or a WebSocket.
Once connected, both transport layers can be treated identically.</p>
</div>
<div class="paragraph">
<p>If the server has been configured to enable encryption, TLS, the connections need to be made using a secure socket or a secure WebSocket.</p>
</div>
<div class="paragraph">
<p>A regular socket connection should be made to the host and port the server has been configured to use for its regular socket listener.
The default port for regular socket connections is <strong>7687</strong>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If TLS is enabled, and no certificate has been specified, the server should automatically generate a self-signed
 TLS certificate. It is vital that your database driver not simply accept any certificate without validating it. If
 you do not verify the certificate it is very simple to bypass the encryption. You should either ensure you have a
 valid signed certificate installed with the server or that your application implements trust on first use.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="handshake"><a class="anchor" href="#handshake"></a>Handshake</h3>
<div class="paragraph">
<p>After connecting, a handshake takes place to establish which Bolt protocol version should be used for that connection.
This handshake is a <em>version-independent</em> mini-protocol which is guaranteed to remain the same, regardless of preferred or available protocol versions.</p>
</div>
<div class="paragraph">
<p>In the handshake, the client first sends a magic four byte preamble (6060 B017) followed by four protocol versions it supports, in order of preference.
The proposal is always represented as four 32-bit unsigned integers.
Each integer represents a proposed protocol version to use, or zero (<code>00 00 00 00</code>) for "none".</p>
</div>
<div class="paragraph">
<p>The server will respond with a single 32-bit unsigned integer representing the chosen protocol.
This will always represent the highest-priority protocol version the server supports.
If none of the proposed protocols are supported, the server responds with zero (<code>00 00 00 00</code>) and closes the connection.</p>
</div>
<div class="listingblock">
<div class="title">Initial handshake</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange">Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
      #  Version 1      None         None         None

Server: 00 00 00 01
      #   Choose
      #  version 1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">No supported version</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange">Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 06  00 00 00 00  00 00 00 00  00 00 00 00
      #   Version 6      None         None         None

Server: 00 00 00 00
      #    None
      #  supported

Server: &lt;disconnect&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="message_transfer_encoding"><a class="anchor" href="#message_transfer_encoding"></a>Message transfer encoding</h3>
<div class="paragraph">
<p>Bolt encodings each message using a chunked transfer encoding.
Each message is transferred as one or more <code>chunks</code> of data.
Each chunk starts with a two-byte header, an unsigned big-endian 16-bit integer, representing the size of the chunk not including the header.
A message can be divided across multiple chunks, allowing client and server alike to transfer large messages without having to determine the length of the entire message in advance.</p>
</div>
<div class="paragraph">
<p>Each message ends with two bytes with the value <code>00 00</code>, these are not counted towards the chunk length.</p>
</div>
<div class="listingblock">
<div class="title">A message in one chunk</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_chunking_example">Chunk size: 16
Message data: 00 01 02 03  04 05 06 07  08 09 0A 0B  0C 0D 0E 0F

00 10  00 01 02 03  04 05 06 07  08 09 0A 0B  0C 0D 0E 0F  00 00
chunk  |                    Message                     |   End
header |                     Data                       |  Marker</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">A message split in two chunks</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_chunking_example">Chunk size: 16
Message data: 00 01 02 03  04 05 06 07  08 09 0A 0B  0C 0D 0E 0F  01 02 03 04

00 10  00 01 02 03  04 05 06 07  08 09 0A 0B  0C 0D 0E 0F  00 04  01 02 03 04  00 00
chunk1 |                    Message                     |  chunk2 | Message |   End
header |                     Data                       |  header |  Data   |  Marker</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Two messages</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_chunking_example">Chunk size: 16
Message 1 data: 00 01 02 03  04 05 06 07  08 09 0A 0B  0C  0D 0E 0F
Message 2 data: 0F 0E 0D 0C  0B 0A 09 08

00 10  00 01 02 03  04 05 06 07  08 09 0A 0B  0C 0D 0E 0F  00 00
chunk  |                   Message 1                    |   End
header |                     Data                       |  Marker

00 08  0F 0E 0D 0C  0B 0A 09 08  00 00
chunk  |       Message 2      |   End
header |         Data         |  Marker</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disconnecting"><a class="anchor" href="#disconnecting"></a>Disconnecting</h3>
<div class="paragraph">
<p>A session ends when its communication socket is closed.
Typically, this will be closed by the client.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="messaging"><a class="anchor" href="#messaging"></a>Messaging layer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section discusses the semantic meaning and layout of protocol messages.
For details on how database types are represented in binary form, see <a href="#serialization">Message Serialization</a>.</p>
</div>
<div class="paragraph">
<p>Clients may send request messages at any time after a session is <a href="#message-init">initialized</a>.
Clients may <a href="#messaging-pipelining">pipeline</a> requests, sending multiple requests together.</p>
</div>
<div class="paragraph">
<p>Servers must fully respond to each request before the next request is processed and processing of requests within a session must be done in the same order in which the requests.</p>
</div>
<div class="paragraph">
<p>Servers must ignore messages sent by the client after a failure occurs on the server, until the client has acknowledged the failure. See Failure &amp; Acknowledgement.</p>
</div>
<div class="paragraph">
<p>For each request message sent, clients must anticipate receiving zero or more detail messages followed by exactly one summary message.
The detail messages deliver the response content, while a summary message denotes the end of the response and any response metadata.
Note that "detail" and "summary" are classifications of message, not specific message types.
For example, <code>RECORD</code> messages are classed as detail messages and <code>SUCCESS</code> messages as summary messages.</p>
</div>
<div class="paragraph">
<p>The diagrams below illustrates a basic exchange wherein the client sends a request message and receives a series of response messages.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/simple-exchange.png" alt="simple exchange"></span></p>
</div>
<div class="sect2">
<h3 id="initialization"><a class="anchor" href="#initialization"></a>Initialization</h3>
<div class="paragraph">
<p>Before a session can be used to <a href="#message-run">run</a> queries, it must be <a href="#message-init">initialized</a>.
The <code>INIT</code> message should be sent by the client as the first message it sends after <a href="#handshake">negotiating
protocol version</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="messaging-pipelining"><a class="anchor" href="#messaging-pipelining"></a>Pipelining</h3>
<div class="paragraph">
<p>The client is not required to wait for a response before sending more messages.
Sending multiple messages together like this is called pipelining:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/pipelining.png" alt="pipelining"></span></p>
</div>
<div class="paragraph">
<p>For performance reasons, it is recommended that clients use pipelining as much as possible.
Through pipelining, multiple messages can be transmitted together in the same network package, significantly reducing latency and increasing throughput.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A common technique is to buffer outgoing messages on the client until the last possible moment, such as when a
commit is issued or a result is read by the application, and then sending all messages in the buffer together.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="failure-handling"><a class="anchor" href="#failure-handling"></a>Failure handling</h3>
<div class="paragraph">
<p>Because the protocol leverages pipelining, the client and the server need to agree on what happens when a failure
occurs, otherwise messages that were sent assuming no failure would occur might have unintended effects.</p>
</div>
<div class="paragraph">
<p>When requests fail on the server, the server will send the client a <code>FAILURE</code> message.
The client must acknowledge the <code>FAILURE</code> message by sending an <code>ACK_FAILURE</code> message to the server.
Until the server receives the <code>ACK_FAILURE</code> message, it will send an <code>IGNORED</code> message in response to any other message from the client, including messages that were sent in a pipeline.</p>
</div>
<div class="paragraph">
<p>The diagram below illustrates a typical flow involving <code>ACK_FAILURE</code> messages:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/failure-ack.png" alt="failure ack"></span></p>
</div>
<div class="paragraph">
<p>Here, the original failure is acknowledged immediately by the client, allowing the subsequent RUN to be actioned as expected.</p>
</div>
<div class="paragraph">
<p>This second diagram shows a sequence where a pair of request messages are sent together:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/failure-optimistic.png" alt="failure optimistic"></span></p>
</div>
<div class="paragraph">
<p>Here, the client optimistically sends a pair of messages. The first of these fails and the second is consequently <code>IGNORED</code>.
Once the client acknowledges the failure, it is then able to resend a corrected RUN message.</p>
</div>
</div>
<div class="sect2">
<h3 id="messages"><a class="anchor" href="#messages"></a>Messages</h3>
<div class="paragraph">
<p>Protocol messages are represented as <a href="#structures">serialized structures</a>.</p>
</div>
<div class="sect3">
<h4 id="message-init"><a class="anchor" href="#message-init"></a>INIT</h4>
<div class="paragraph">
<p>The <code>INIT</code> message is a client message used once to initialize the session.
This message is always the first message the client sends after <a href="#handshake">negotiating protocol version</a>.
Sending any message other than <code>INIT</code> as the first message to the server will result in a <code>FAILURE</code>. As described in <a href="#failure-handling">Failure handling</a> the client must acknowledge failures using <code>ACK_FAILURE</code>, after which <code>INIT</code> may be reattempted.</p>
</div>
<div class="paragraph">
<p>All parameters in the <code>INIT</code> message are required.</p>
</div>
<div class="ulist">
<div class="title">Response</div>
<ul>
<li>
<p><code>SUCCESS {}</code> if initialization has completed successfully</p>
</li>
<li>
<p><code>FAILURE {"code": &#8230;&#8203;, "message": &#8230;&#8203;}</code> if the request was malformed, or if initialization cannot be performed at this time, or if the authorization failed.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_request_message_struct">InitMessage (signature=0x01) {
    String clientName
    Map&lt;String,Value&gt; authToken
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

B2 01 8C 4D  79 43 6C 69  65 6E 74 2F  31 2E 30 A3
86 73 63 68  65 6D 65 85  62 61 73 69  63 89 70 72
69 6E 63 69  70 61 6C 85  6E 65 6F 34  6A 8B 63 72
65 64 65 6E  74 69 61 6C  73 86 73 65  63 72 65 74</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Initialize message parameters</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clientName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A name and version for the client, if the user has allowed usage data collection, this is used to track popular clients. Example: "MyClient/1.0"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">authToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An authorization token used to authenticate to the database. The token must contain either just the entry { "scheme" : "none" } or the keys scheme, principal, and credentials. Example { "scheme": "basic", "principal": "user", "credentials": "secret"}". If no scheme is provided, it defaults to "none".</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="message-run"><a class="anchor" href="#message-run"></a>RUN</h4>
<div class="paragraph">
<p>The <code>RUN</code> message is a client message used to pass a statement for execution on the server. It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_request_message_struct">RunMessage (signature=0x10) {
    String             statement
    Map&lt;String,Value&gt;  parameters
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The content and format of the statement string is dependent on the server, and the Bolt Protocol makes no assumption about this.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On receipt of a <code>RUN</code> message, the server will start a new job by executing the statement with the parameters supplied.
If successful, the subsequent response will consist of a single <code>SUCCESS</code> message; if not, a <code>FAILURE</code> response will be sent instead.
A successful job will always produce a result stream which must then be explicitly consumed (via <code>PULL_ALL</code> or <code>DISCARD_ALL</code>), even if empty.</p>
</div>
<div class="paragraph">
<p>Depending on the statement you are executing, additional metadata may be returned in both the <code>SUCCESS</code> message from the <code>RUN</code>, as well as in the final <code>SUCCESS</code> after the stream has been consumed.
It is up to the statement you are running to determine what meta data to return.
Notably, most queries will contain a 'fields' metadata section in the <code>SUCCESS</code> message for the <code>RUN</code> statement, which lists the result record field names, and a <code>result_available_after</code> section measuring the number of milliseconds it took for the results to be available for consumption.
We list further examples of meta data in the <a href="#examples">examples section</a>.</p>
</div>
<div class="paragraph">
<p>In the case where a previous result stream has not yet been fully consumed, an attempt to <code>RUN</code> a new job will trigger a <code>FAILURE</code> response.</p>
</div>
<div class="paragraph">
<p>If an unacknowledged failure is pending from a previous exchange, the server will immediately respond with a single
<code>IGNORED</code> message and take no further action.</p>
</div>
<div class="ulist">
<div class="title">Response</div>
<ul>
<li>
<p><code>SUCCESS {"fields": &#8230;&#8203;, "result_available_after"}</code> if the statement has been accepted for execution</p>
</li>
<li>
<p><code>FAILURE {"code": &#8230;&#8203;, "message": &#8230;&#8203;}</code> if the request was malformed or if a statement may not be executed at this time</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: RUN &quot;RETURN 1 AS num&quot; {}

B2 10 8F 52  45 54 55 52  4E 20 31 20  41 53 20 6E  75 6D A0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-discard-all"><a class="anchor" href="#message-discard-all"></a>DISCARD_ALL</h4>
<div class="paragraph">
<p>The <code>DISCARD_ALL</code> message is a client message used to discard all remaining items from the active result
stream. It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_request_message_struct">DiscardAllMessage (signature=0x2F) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On receipt of a <code>DISCARD_ALL</code> message, the server will dispose of all remaining items from the active result stream, close the stream and send a single <code>SUCCESS</code> message to the client.
If no result stream is currently active, the server will respond with a single <code>FAILURE</code> message.</p>
</div>
<div class="paragraph">
<p>If an unacknowledged failure is pending from a previous exchange, the server will immediately respond with a single <code>IGNORED</code> message and take no further action.</p>
</div>
<div class="ulist">
<div class="title">Response</div>
<ul>
<li>
<p><code>SUCCESS {}</code> if the result stream has been successfully discarded</p>
</li>
<li>
<p><code>FAILURE {"code": &#8230;&#8203;, "message": &#8230;&#8203;}</code> if no result stream is currently available</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: DISCARD_ALL

B0 2F</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-pull-all"><a class="anchor" href="#message-pull-all"></a>PULL_ALL</h4>
<div class="paragraph">
<p>The <code>PULL_ALL</code> message is a client message used to retrieve all remaining items from the active result stream.
It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_request_message_struct">PullAllMessage (signature=0x3F) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On receipt of a <code>PULL_ALL</code> message, the server will send all remaining result data items to the client, each in a single <code>RECORD</code> message.
The server will then close the stream and send a single <code>SUCCESS</code> message optionally containing summary information on the data items sent.
If an error is encountered, the server must instead send a <code>FAILURE</code> message, discard all remaining data items and close the stream.</p>
</div>
<div class="paragraph">
<p>If an unacknowledged failure is pending from a previous exchange, the server will immediately respond with a single <code>IGNORED</code> message and take no further action.</p>
</div>
<div class="ulist">
<div class="title">Response</div>
<ul>
<li>
<p><code>SUCCESS {&#8230;&#8203;}</code> if the result stream has been successfully transferred</p>
</li>
<li>
<p><code>FAILURE {"code": &#8230;&#8203;, "message": &#8230;&#8203;}</code> if no result stream is currently available or if retrieval fails</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: PULL_ALL

B0 3F</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-ack-failure"><a class="anchor" href="#message-ack-failure"></a>ACK_FAILURE</h4>
<div class="paragraph">
<p>The <code>ACK_FAILURE</code> message is a client message used to acknowledge a failure the server has sent.</p>
</div>
<div class="paragraph">
<p>The following actions are performed by <code>ACK_FAILURE</code>:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In some cases, it may be preferable to use <code>RESET</code> after a failure, to clear
the entire state of the connection.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>clear any outstanding <code>FAILURE</code> state</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#examples-ack-failure">Error handling with ACK_FAILURE</a> for an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_request_message_struct">AckFailureMessage (signature=0x0E) {
}</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Response</div>
<ul>
<li>
<p><code>SUCCESS {}</code> if the session was successfully reset</p>
</li>
<li>
<p><code>FAILURE {"code": &#8230;&#8203;, "message": &#8230;&#8203;}</code> if there is no failure waiting to be cleared</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: ACK_FAILURE

B0 0E</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-reset"><a class="anchor" href="#message-reset"></a>RESET</h4>
<div class="paragraph">
<p>The <code>RESET</code> message is a client message used to return the current session to a "clean" state.
It will cause the session to <code>IGNORE</code> any message it is currently processing, as well as any message before <code>RESET</code> that had not yet begun processing.
This allows <code>RESET</code> to abort long-running operations.
It also means clients must be careful about pipelining <code>RESET</code>.
Only send this if you are not currently waiting for a result from a prior message, or if you want to explicitly abort any prior message.</p>
</div>
<div class="paragraph">
<p>The following actions are performed by <code>RESET</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>force any currently processing message to abort with <code>IGNORE</code></p>
</li>
<li>
<p>force any pending messages that have not yet started processing to be <code>IGNORED</code></p>
</li>
<li>
<p>clear any outstanding <code>FAILURE</code> state</p>
</li>
<li>
<p>dispose of any outstanding result records</p>
</li>
<li>
<p>rollback the current transaction (if any)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#examples-reset">Error handling with RESET</a> for example usage.</p>
</div>
<div class="paragraph">
<p>Also, see <a href="#message-ack-failure">ACK_FAILURE</a> for a message that only clears <code>FAILURE</code> state</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_request_message_struct">ResetMessage (signature=0x0F) {
}</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Response</div>
<ul>
<li>
<p><code>SUCCESS {}</code> if the session was successfully reset</p>
</li>
<li>
<p><code>FAILURE {"code": &#8230;&#8203;, "message": &#8230;&#8203;}</code> if a reset is not currently possible</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: RESET

B0 0F</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-record"><a class="anchor" href="#message-record"></a>RECORD</h4>
<div class="paragraph">
<p>The <code>RECORD</code> message is a server detail message used to deliver data from the server to the client.
Each record message contains a single List, which in turn contains the fields of the record in order.
It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_response_message_struct">RecordMessage (signature=0x71) {
    List&lt;Value&gt; fields
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: RECORD [1,2,3]

B1 71 93 01  02 03</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-success"><a class="anchor" href="#message-success"></a>SUCCESS</h4>
<div class="paragraph">
<p>The <code>SUCCESS</code> message is a server summary message used to signal that a corresponding client message has been received and actioned as intended.
The message contains a map of metadata, the contents of which depend on the original request.
It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_response_message_struct">SuccessMessage (signature=0x70) {
    Map&lt;String,Value&gt; metadata
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: SUCCESS { &quot;fields&quot;: [&quot;name&quot;, &quot;age&quot;]}

B1 70 A1 86  66 69 65 6C  64 73 92 84  6E 61 6D 65
83 61 67 65</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-failure"><a class="anchor" href="#message-failure"></a>FAILURE</h4>
<div class="paragraph">
<p>The <code>FAILURE</code> message is a server summary message used to signal that a corresponding client message has encountered an error while being processed.
It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_response_message_struct">FailureMessage (signature=0x7F) {
    Map&lt;String,Value&gt; metadata
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>FAILURE</code> messages contain metadata providing details regarding the primary failure that has occurred.
This metadata is a simple map containing a code and a message.</p>
</div>
<div class="paragraph">
<p>When a <code>FAILURE</code> occurs, in most cases any open transaction will be rolled back.
However, if the <code>FAILURE</code> is classified as a <code>client error</code>, the transaction will be left open and can be used again
after the <code>FAILURE</code> has been acknowledged.
This is mainly to support user-driven queries, where a database administrator may have built up a large transaction, and
we do not want a simple spelling mistake to roll it all back.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: FAILURE { &quot;code&quot;: &quot;Neo.ClientError.Statement.SyntaxError&quot;, &quot;message&quot;: &quot;Invalid syntax.&quot; }

B1 7F A2 84  63 6F 64 65  D0 25 4E 65  6F 2E 43 6C
69 65 6E 74  45 72 72 6F  72 2E 53 74  61 74 65 6D
65 6E 74 2E  53 79 6E 74  61 78 45 72  72 6F 72 87
6D 65 73 73  61 67 65 8F  49 6E 76 61  6C 69 64 20
73 79 6E 74  61 78 2E</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="message-ignored"><a class="anchor" href="#message-ignored"></a>IGNORED</h4>
<div class="paragraph">
<p>The <code>IGNORED</code> message is a server summary message used to signal that a corresponding client message has been ignored and not actioned.
It has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_response_message_struct">IgnoredMessage (signature=0x7E) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A client message will be ignored if an earlier failure has not yet been acknowledged by the client via a <code>RESET</code> message.
For example, this will occur if the client optimistically sends a group of messages, one of which fails during execution: all subsequent messages in that group will then be ignored.
Note that the original <code>PULL_ALL</code> message was never processed by the server.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: IGNORED

B0 7E</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="serialization"><a class="anchor" href="#serialization"></a>Message Serialization</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="overview_2"><a class="anchor" href="#overview_2"></a>Overview</h3>
<div class="paragraph">
<p>This section discusses how messages and the database type system are represented by the protocol using a custom binary serialization format.</p>
</div>
<div class="paragraph">
<p>For details on the layout and meaning of specific messages, see <a href="#messaging">Messaging layer</a>.</p>
</div>
<table id="type-system-mapping" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Types overview</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#null">Null</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents the absence of a value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#booleans">Boolean</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean true or false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ints">Integer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#floats">Float</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit floating point number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#strings">String</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8 encoded strings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#lists">List</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ordered collection of values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#maps">Map</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unordered, keyed collection of values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#node-structure">Node</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A node in the graph with optional properties and labels</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#rel-structure">Relationship</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A directed, typed connection between two nodes. Each relationship may have properties and always has an identity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#path-structure">Path</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The record of a directed walk through the graph, a sequence of zero or more segments*. A path with zero segments consists of a single node.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A segment is the record of a single step traversal through a graph, encompassing a start node, a relationship traversed either forwards or backwards and an end node.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="markers"><a class="anchor" href="#markers"></a>Markers</h3>
<div class="paragraph">
<p>Every value begins with a marker byte.
The marker contains information on data type as well as direct or indirect size information for those types that require it.
How that size information is encoded varies by marker type.</p>
</div>
<div class="paragraph">
<p>Some values, such as <code>true</code>, can be encoded within a single marker byte and many small integers (specifically between -16 and +127) are also encoded within a single byte.</p>
</div>
<div class="paragraph">
<p>A number of marker bytes are reserved for future expansion of the format itself.
These bytes should not be used, and encountering them in a stream should treated as an error.</p>
</div>
</div>
<div class="sect2">
<h3 id="sized_values"><a class="anchor" href="#sized_values"></a>Sized Values</h3>
<div class="paragraph">
<p>Some value types require variable length representations and, as such, have their size explicitly encoded.
These values generally begin with a single marker byte followed by a size followed by the data content itself.
Here, the marker denotes both type and scale and therefore determines the number of bytes used to represent the size of the data.
The size itself is either an 8-bit, 16-bit or 32-bit big-endian unsigned integer.</p>
</div>
<div class="paragraph">
<p>The diagram below illustrates the general layout for a sized value, here with a 16-bit size:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/packstream-sized.png" alt="packstream sized"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="null"><a class="anchor" href="#null"></a>Null</h3>
<div class="paragraph">
<p>Null is always encoded using the single marker byte <code>0xC0</code>.</p>
</div>
<div class="listingblock">
<div class="title">Absence of value - null</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: null

C0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="booleans"><a class="anchor" href="#booleans"></a>Booleans</h3>
<div class="paragraph">
<p>Boolean values are encoded within a single marker byte, using <code>0xC3</code> to denote true and <code>0xC2</code> to denote false.</p>
</div>
<div class="listingblock">
<div class="title">Boolean true</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: true

C3</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Boolean false</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: false

C2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ints"><a class="anchor" href="#ints"></a>Integers</h3>
<div class="paragraph">
<p>Integer values occupy either 1, 2, 3, 5 or 9 bytes depending on magnitude and are stored as big-endian signed values.
Several markers are designated specifically as <code>TINY_INT</code> values and can therefore be used to pass a small number in a single byte.
These markers can be identified by a zero high-order bit or by a high-order nibble containing only ones.</p>
</div>
<div class="paragraph">
<p>The available encodings are illustrated below and each shows a valid representation for the decimal value 42, with marker bytes in green:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/packstream-integers.png" alt="packstream integers"></span></p>
</div>
<div class="paragraph">
<p>Note that while encoding small numbers in wider formats is supported, it is generally recommended to use the most compact representation possible.
The following table shows the optimal representation for every possible integer:</p>
</div>
<div class="listingblock">
<div class="title">Simple integer</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: 1

01</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Min integer</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: -9223372036854775808

CB 80 00 00  00 00 00 00  00</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Max integer</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: 9223372036854775807

CB 7F FF FF  FF FF FF FF  FF</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Suggested integer representations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Range Minimum</th>
<th class="tableblock halign-right valign-top">Range Maximum</th>
<th class="tableblock halign-center valign-top">Suggested representation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">-9 223 372 036 854 775 808</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">-2 147 483 649</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_64</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">-2 147 483 648</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">-32 769</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">-32 768</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">-129</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">-128</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">-17</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">-16</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">+127</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>TINY_INT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">+128</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">+32 767</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">+32 768</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">+2 147 483 647</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">+2 147 483 648</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">+9 223 372 036 854 775 807</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_64</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="floats"><a class="anchor" href="#floats"></a>Floating Point Numbers</h3>
<div class="paragraph">
<p>These are double-precision floating points for approximations of any number, notably for representing fractions and decimal numbers.
Floats are encoded as a single <code>0xC1</code> marker byte followed by 8 bytes, formatted according to the IEEE 754 floating-point "double format" bit layout.</p>
</div>
<div class="paragraph">
<p>Bit 63 (the bit that is selected by the mask <code>0x8000000000000000</code>) represents the sign of the number.</p>
</div>
<div class="paragraph">
<p>Bits 62-52 (the bits that are selected by the mask <code>0x7ff0000000000000</code>) represent the exponent.</p>
</div>
<div class="paragraph">
<p>Bits 51-0 (the bits that are selected by the mask <code>0x000fffffffffffff</code>) represent the significand (sometimes called the mantissa) of the number.</p>
</div>
<div class="listingblock">
<div class="title">Simple floating point</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: 1.1

C1 3F F1 99 99 99 99 99 9A</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Negative floating point</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: -1.1

C1 BF F1 99 99 99 99 99 9A</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="strings"><a class="anchor" href="#strings"></a>String</h3>
<div class="paragraph">
<p>String data is represented as UTF-8 encoded binary data.
Note that sizes used for string are the byte counts of the UTF-8 encoded data, not the character count of the original string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. String markers</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 50%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Marker</th>
<th class="tableblock halign-left valign-top">Size</th>
<th class="tableblock halign-left valign-top">Maximum data size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0x80</code>..<code>0x8F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contained within low-order nibble of marker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65 535 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 294 967 295 bytes</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="tiny_strings_empty_strings"><a class="anchor" href="#tiny_strings_empty_strings"></a>Tiny Strings &amp; Empty Strings</h4>
<div class="paragraph">
<p>For encoded string containing fewer than 16 bytes, including empty strings, the marker byte should contain the high-order nibble <code>1000</code> followed by a low-order nibble containing the size.
The encoded data then immediately follows the marker.
The example below shows how the string "Hello" would be represented:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/packstream-tinystring.png" alt="packstream tinystring"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="regular_strings"><a class="anchor" href="#regular_strings"></a>Regular Strings</h4>
<div class="paragraph">
<p>For encoded string containing 16 bytes or more, the marker <code>0xD0</code>, <code>0xD1</code> or <code>0xD2</code> should be used, depending on scale.
This marker is followed by the size and the UTF-8 encoded data as in the example below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/packstream-string.png" alt="packstream string"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="string-examples"><a class="anchor" href="#string-examples"></a>Examples</h4>
<div class="listingblock">
<div class="title">Tiny string</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: &quot;a&quot;

81 61</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Regular string</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: &quot;abcdefghijklmnopqrstuvwxyz&quot;

D0 1A 61 62  63 64 65 66  67 68 69 6A  6B 6C 6D 6E
6F 70 71 72  73 74 75 76  77 78 79 7A</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">String with special characters</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: &quot;En å flöt över ängen&quot;

D0 18 45 6E  20 C3 A5 20  66 6C C3 B6  74 20 C3 B6
76 65 72 20  C3 A4 6E 67  65 6E</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lists"><a class="anchor" href="#lists"></a>Lists</h3>
<div class="paragraph">
<p>Lists are heterogeneous sequences of values and permit a mixture of types within the same list.
The size of a list denotes the number of items within that list, not the total packed byte size.
The markers used to denote a list are described in the table below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. List markers</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 50%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Marker</th>
<th class="tableblock halign-left valign-top">Size</th>
<th class="tableblock halign-left valign-top">Maximum list size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0x90</code>..<code>0x9F</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contained within low-order nibble of marker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255 items</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65 535 items</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 294 967 295 items</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="tiny_lists_empty_lists"><a class="anchor" href="#tiny_lists_empty_lists"></a>Tiny Lists &amp; Empty Lists</h4>
<div class="paragraph">
<p>For lists containing fewer than 16 items, including empty lists, the marker byte should contain the high-order nibble <code>1001</code> followed by a low-order nibble containing the size.
The items within the list are then serialised in order  immediately after the marker.</p>
</div>
</div>
<div class="sect3">
<h4 id="regular_lists"><a class="anchor" href="#regular_lists"></a>Regular Lists</h4>
<div class="paragraph">
<p>For lists containing 16 items or more, the marker <code>0xD4</code>, <code>0xD5</code> or <code>0xD6</code> should be used, depending on scale.
This marker is followed by the size and list items, serialized in order.</p>
</div>
</div>
<div class="sect3">
<h4 id="list-examples"><a class="anchor" href="#list-examples"></a>Examples</h4>
<div class="listingblock">
<div class="title">Empty list</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: []

90</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Tiny list</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: [1,2,3]

93 01 02 03</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Regular list</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: [1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0]

D4 14 01 02  03 04 05 06  07 08 09 00  01 02 03 04
05 06 07 08  09 00</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="maps"><a class="anchor" href="#maps"></a>Maps</h3>
<div class="paragraph">
<p>Maps are sized sequences of pairs of keys and values and permit a mixture of types within the same map.
The size of a map denotes the number of pairs within that map, not the total packed byte size.
Keys are unique within a map, however the serialization format notably technically allows duplicate keys to be sent.
Though if duplicate keys are sent, this is a violation of the bolt protocol and an error will occur.
The markers used to denote a map are described in the table below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Map markers</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 50%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Marker</th>
<th class="tableblock halign-left valign-top">Size</th>
<th class="tableblock halign-left valign-top">Maximum map size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xA0</code>..<code>0xAF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contained within low-order nibble of marker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 entries</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255 entries</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD9</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65 535 entries</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDA</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 294 967 295 entries</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="tiny_maps_empty_maps"><a class="anchor" href="#tiny_maps_empty_maps"></a>Tiny Maps &amp; Empty Maps</h4>
<div class="paragraph">
<p>For maps containing fewer than 16 key-value pairs, including empty maps, the marker byte should contain the high-order nibble <code>1010</code> followed by a low-order nibble containing the size.
The items within the map are then serialised in key-value-key-value order immediately after the marker.</p>
</div>
</div>
<div class="sect3">
<h4 id="regular_maps"><a class="anchor" href="#regular_maps"></a>Regular Maps</h4>
<div class="paragraph">
<p>For maps containing 16 pairs or more, the marker <code>0xD8</code>, <code>0xD9</code> or <code>0xDA</code> should be used, depending on scale.
This marker is followed by the size and map entries, serialised in key-value-key-value order.</p>
</div>
</div>
<div class="sect3">
<h4 id="map-examples"><a class="anchor" href="#map-examples"></a>Examples</h4>
<div class="listingblock">
<div class="title">Empty map</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: {}

A0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Tiny map</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: {&quot;a&quot;:1}

A1 81 61 01</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Regular map</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: {&quot;a&quot;:1,&quot;b&quot;:1,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5,&quot;f&quot;:6,&quot;g&quot;:7,&quot;h&quot;:8,&quot;i&quot;:9,&quot;j&quot;:0,&quot;k&quot;:1,&quot;l&quot;:2,&quot;m&quot;:3,&quot;n&quot;:4,&quot;o&quot;:5,&quot;p&quot;:6}

D8 10 81 61  01 81 62 01  81 63 03 81  64 04 81 65
05 81 66 06  81 67 07 81  68 08 81 69  09 81 6A 00
81 6B 01 81  6C 02 81 6D  03 81 6E 04  81 6F 05 81
70 06</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="structures"><a class="anchor" href="#structures"></a>Structures</h3>
<div class="paragraph">
<p>Structures represent composite values and consist, beyond the marker, of a single byte signature followed by a sequence of fields, each an individual value.
The size of a structure is measured as the number of fields, not the total packed byte size.
The markers used to denote a structure are described in the table below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Structure markers</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 50%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Marker</th>
<th class="tableblock halign-left valign-top">Size</th>
<th class="tableblock halign-left valign-top">Maximum structure size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xB0</code>..<code>0xBF</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contained within low-order nibble of marker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 fields</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">255 fields</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit big-endian unsigned integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65 535 fields</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="signature"><a class="anchor" href="#signature"></a>Signature</h4>
<div class="paragraph">
<p>The signature byte is used to identify the type or class of the structure.
Refer to the <a href="#value-structures">Value Structures</a> and <a href="#messages">Message Structures</a> for structures used in the protocol.</p>
</div>
<div class="paragraph">
<p>Signature bytes may hold any value between 0 and +127. Bytes with the high bit set are reserved for future expansion.</p>
</div>
</div>
<div class="sect3">
<h4 id="tiny_structures"><a class="anchor" href="#tiny_structures"></a>Tiny Structures</h4>
<div class="paragraph">
<p>For structures containing fewer than 16 fields, the marker byte should contain the high-order nibble <code>1011</code> followed by a low-order nibble containing the size.
The marker is immediately followed by the signature byte and the field values.</p>
</div>
</div>
<div class="sect3">
<h4 id="regular_structures"><a class="anchor" href="#regular_structures"></a>Regular Structures</h4>
<div class="paragraph">
<p>For structures containing 16 fields or more, the marker <code>0xDC</code> or <code>0xDD</code> should be used, depending on scale.
This marker is followed by the size, the signature byte and the actual fields, serialised in order.</p>
</div>
</div>
<div class="sect3">
<h4 id="struct-examples"><a class="anchor" href="#struct-examples"></a>Examples</h4>
<div class="paragraph">
<p>Assuming a struct with the signature <code>0x01</code> and three fields with values 1,2,3:</p>
</div>
<div class="listingblock">
<div class="title">Tiny structure</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: Struct (signature=0x01) { 1,2,3 }

B3 01 01 02 03</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Regular structure</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_type">Value: Struct (signature=0x01) { 1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6 }

DC 10 01 01  02 03 04 05  06 07 08 09  00 01 02 03
04 05 06</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="value-structures"><a class="anchor" href="#value-structures"></a>Graph Type Structures</h3>
<div class="paragraph">
<p>A number of complex database types are represented as <a href="#structures">Structures</a>.
These include <em>nodes</em>, <em>relationships</em> and <em>paths</em>.</p>
</div>
<div class="sect3">
<h4 id="node-structure"><a class="anchor" href="#node-structure"></a>Node</h4>
<div class="paragraph">
<p>A Node represents a node from a labeled property graph and consists of a unique identifier (within the scope of its origin graph), a list of labels and a map of properties. The general serialised structure is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_value_struct">Node (signature=0x4E) {
    Integer           nodeIdentity
    List&lt;String&gt;        labels
    Map&lt;String, Value&gt;  properties
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rel-structure"><a class="anchor" href="#rel-structure"></a>Relationship</h4>
<div class="paragraph">
<p>A Relationship represents a relationship from a labeled property graph and consists of a unique identifier (within the scope of its origin graph), identifiers for the start and end nodes of that relationship, a type and a map of properties. The general serialised structure is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_value_struct">Relationship (signature=0x52) {
    Integer             relIdentity
    Integer             startNodeIdentity
    Integer             endNodeIdentity
    String              type
    Map&lt;String, Value&gt;  properties
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="path-structure"><a class="anchor" href="#path-structure"></a>Path</h4>
<div class="paragraph">
<p>A Path is a sequence of alternating nodes and relationships corresponding to a walk in the graph.
The path always begins and ends with a node.
Its representation consists of a list of distinct nodes, a list of distinct relationships and a sequence of integers describing the path traversal.
The general serialised structure is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_value_struct">Path (signature=0x50) {
    List&lt;Node&gt; nodes
    List&lt;UnboundRelationship&gt; relationships
    List&lt;Integer&gt; sequence
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The two lists <code>N</code> and <code>R</code> (short for <code>nodes</code> and <code>relationships</code> in the example above) are defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>N</code> contains all the unique nodes in the path</p>
</li>
<li>
<p><code>R</code> contains all the unique relationships in the path</p>
</li>
<li>
<p>For <code>N</code>, the index is an integer commencing with 0 and incrementing by 1</p>
</li>
<li>
<p>For <code>R</code>, the index is an integer commencing with 1 and incrementing by 1</p>
</li>
<li>
<p>The value component for both <code>N</code> and <code>R</code> is the data corresponding to the node or relationship; this comprises the identifier, labels/type, properties etc</p>
</li>
<li>
<p>In <code>N</code>, the first element must <em>always</em> be the first node in the path (thus having 0 as the index)</p>
</li>
<li>
<p>No other <em>explicit</em> rules apply as to either (i) the ordering of the other nodes in <code>N</code>, or (ii) the ordering of any of the relationships in <code>R</code>. However, while not required, it is recommended that implementations aim to list entities (i.e. nodes and relationships) in the order in which they are first encountered while traversing the path. This may help with the efficiency of reading and writing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When transmitting a path between a server and a client, the path is represented as a sequence of integers; we define <code>S</code> (short for <code>sequence</code> in the example above) as the transmitted sequence, and <code>S'</code> as the full sequence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>S</code> must always consist of an even number of integers, or be empty</p>
</li>
<li>
<p>The first, third, &#8230;&#8203; integer in <code>S</code> has a range encompassed by (..,-1] and [1,..). These represent the directed relationships in the path</p>
</li>
<li>
<p>The second, fourth, &#8230;&#8203; integer in <code>S</code> has a range encompassed by [0,..). These represent the nodes in the path</p>
</li>
<li>
<p>By definition, the first node in the path will <em>always</em> have an index of 0, so we exclude this from <code>S</code> upon transmission. The idea is to construct <code>S'</code> by prepending 0 to <code>S</code> on the completion of a successful transmission</p>
</li>
<li>
<p>Let a path <code>P</code> be given by the following transmitted sequence [1, 1, -2, 2]. It follows that the corresponding full sequence, <code>S'</code>, is given by [0, 1, 1, -2, 2]</p>
</li>
<li>
<p>The first integer in <code>S</code> (1) is the index in <code>R</code> corresponding to the first relationship in <code>P</code></p>
</li>
<li>
<p>The second integer in <code>S</code> (1) is the index in <code>N</code> corresponding to the second node in <code>P</code></p>
</li>
<li>
<p>The last integer in <code>S</code> (2) is the index in <code>N</code> corresponding to the last node in <code>P</code></p>
</li>
<li>
<p>When a relationship is represented by a positive integer in <code>S</code> - such as the 1 in position 1 - this means that the relationship is being traversed in the direction of the underlying relationship in the data graph</p>
</li>
<li>
<p>When a relationship is represented by a negative integer in <code>S</code> - such as the -2 in position 3 - this means that the relationship is being traversed against the direction of the underlying relationship in the data graph.
For 'loops' - i.e. a relationship beginning and ending at the same node - a positive integer should be used</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Example</div>
<p>Consider the following path:</p>
</div>
<div class="paragraph">
<p><code>(A)-[:X]&#8594;(B)-[:Y]&#8594;&#169;&#8592;[:Z]-(B)&#8592;[:X]-(A)</code></p>
</div>
<div class="paragraph">
<p>The elements transmitted would be as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>N</code>: <code>(A)</code>, <code>(B)</code>, <code>&#169;</code></p>
</li>
<li>
<p><code>R</code>: <code>[:X]</code>, <code>[:Y]</code>, <code>[:Z]</code></p>
</li>
<li>
<p><code>S</code>: [1, 1, 2, 2, -3, 1, -1, 0]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By definition, the following is also implied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>S'</code>: [0, 1, 1, 2, 2, -3, 1, -1, 0]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similarly, consider the following zero-length path:</p>
</div>
<div class="paragraph">
<p><code>(A)</code></p>
</div>
<div class="paragraph">
<p>The elements transmitted would be as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>N</code>: <code>(A)</code></p>
</li>
<li>
<p><code>R</code>: &lt;empty&gt;</p>
</li>
<li>
<p><code>S</code>: &lt;empty&gt;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where the following is implied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>S'</code>: [0]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="unbound-rel-structure"><a class="anchor" href="#unbound-rel-structure"></a>UnboundRelationship</h4>
<div class="paragraph">
<p>An UnboundRelationship represents a relationship relative to a separately known start point and end point.
The general serialised structure is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_value_struct">UnboundRelationship (signature=0x72) {
    Integer             relIdentity
    String              type          // e.g. &quot;KNOWS&quot;
    Map&lt;String, Value&gt;  properties    // e.g. {since:1999}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="marker_table"><a class="anchor" href="#marker_table"></a>Marker table</h3>
<div class="paragraph">
<p>These are all the marker bytes:</p>
</div>
<table id="markers" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Marker table</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Marker</th>
<th class="tableblock halign-center valign-top">Binary</th>
<th class="tableblock halign-center valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0x00</code>..<code>0x7F</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xxxxxxx</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>+TINY_INT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer 0 to 127</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0x80</code>..<code>0x8F</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1000xxxx</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>TINY_STRING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8 encoded string (fewer than 2<sup>4</sup> bytes)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0x90</code>..<code>0x9F</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1001xxxx</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>TINY_LIST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List (fewer than 2<sup>4</sup> items)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xA0</code>..<code>0xAF</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1010xxxx</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>TINY_MAP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map (fewer than 2<sup>4</sup> key-value pairs)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xB0</code>..<code>0xBF</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1011xxxx</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>TINY_STRUCT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structure (fewer than 2<sup>4</sup> fields)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC0</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC1</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11000001</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>FLOAT_64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit floating point number (double)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC2</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11000010</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>FALSE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean false</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC3</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11000011</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>TRUE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean true</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC4</code>..<code>0xC7</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>110001xx</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC8</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11001000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xC9</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11001001</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xCA</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11001010</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xCB</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11001011</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>INT_64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64-bit signed integer</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xCC</code>..<code>0xCF</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11001100</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD0</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>STRING_8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8 encoded string (fewer than 2<sup>8</sup> bytes)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD1</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010001</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>STRING_16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8 encoded string (fewer than 2<sup>16</sup> bytes)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD2</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010010</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>STRING_32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UTF-8 encoded string (fewer than 2<sup>32</sup> bytes)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD3</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010011</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD4</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010100</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>LIST_8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List (fewer than 2<sup>8</sup> items)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD5</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010101</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>LIST_16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List (fewer than 2<sup>16</sup> items)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD6</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010110</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>LIST_32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List (fewer than 2<sup>32</sup> items)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD7</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11010111</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD8</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11011000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>MAP_8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map (fewer than 2<sup>8</sup> key-value pairs)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xD9</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11011001</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>MAP_16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map (fewer than 2<sup>16</sup> key-value pairs)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDA</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11011010</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>MAP_32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map (fewer than 2<sup>32</sup> key-value pairs)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDB</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11011011</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDC</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11011100</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>STRUCT_8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structure (fewer than 2<sup>8</sup> fields)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDD</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>11011101</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>STRUCT_16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structure (fewer than 2<sup>16</sup> fields)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xDE</code>..<code>0xEF</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1110xxxx</code></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>0xF0</code>..<code>0xFF</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1111xxxx</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>-TINY_INT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer -1 to -16</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains concrete examples showing how to perform tasks using the full Bolt protocol stack.</p>
</div>
<div class="sect2">
<h3 id="running_a_cypher_query"><a class="anchor" href="#running_a_cypher_query"></a>Running a Cypher query</h3>
<div class="paragraph">
<p>This illustrates running a simple Cypher query without parameters, and retrieving the results.</p>
</div>
<div class="listingblock">
<div class="title">Run query</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

Client: RUN &quot;RETURN 1 AS num&quot; {}

  00 13 b2 10  8f 52 45 54  55 52 4e 20  31 20 41 53
  20 6e 75 6d  a0 00 00

Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

  00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
  6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
  62 6C 65 5F  61 66 74 65  72 0C 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

Server: RECORD [1]

  00 04 b1 71  91 01 00 00

Server: SUCCESS { &quot;type&quot;: &quot;r&quot;, &quot;result_consumed_after&quot;: 12 }

 00 22 B1 70  A2 84 74 79  70 65 81 72  D0 15 72 65
 73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
 74 65 72 0C  00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelining"><a class="anchor" href="#pipelining"></a>Pipelining</h3>
<div class="paragraph">
<p>This illustrates running two statements and retrieving their results, without waiting for the server to respond
in-between.</p>
</div>
<div class="paragraph">
<p>Note that these two statements are executed in two individual transactions, implicitly created for each statement.</p>
</div>
<div class="listingblock">
<div class="title">Pipelining</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

# Batch of messages
Client: RUN &quot;RETURN 1 AS num&quot; {}

  00 13 b2 10  8f 52 45 54  55 52 4e 20  31 20 41 53
  20 6e 75 6d  a0 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

Client: RUN &quot;RETURN 1 AS num&quot; {}

  00 13 b2 10  8f 52 45 54  55 52 4e 20  31 20 41 53
  20 6e 75 6d  a0 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

# Server responses
Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

  00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
  6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
  62 6C 65 5F  61 66 74 65  72 0C 00 00

Server: RECORD [1]

  00 04 b1 71  91 01 00 00

Server: SUCCESS { &quot;type&quot;: &quot;r&quot;, &quot;result_consumed_after&quot;: 12 }

 00 22 B1 70  A2 84 74 79  70 65 81 72  D0 15 72 65
 73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
 74 65 72 0C  00 00

Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

  00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
  6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
  62 6C 65 5F  61 66 74 65  72 0C 00 00

Server: RECORD [1]

  00 04 b1 71  91 01 00 00

Server: SUCCESS { &quot;type&quot;: &quot;r&quot;, &quot;result_consumed_after&quot;: 12 }

 00 22 B1 70  A2 84 74 79  70 65 81 72  D0 15 72 65
 73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
 74 65 72 0C  00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-reset"><a class="anchor" href="#examples-reset"></a>Error handling with RESET</h3>
<div class="paragraph">
<p>This illustrates how the server behaves when a request fails, and shows how the server ignores incoming messages until a <code>RESET</code> message is received.</p>
</div>
<div class="listingblock">
<div class="title">Error handling with RESET</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

# Message with syntax error
Client: RUN &quot;This will cause a syntax error&quot; {}

  00 23 b2 10  d0 1e 54 68  69 73 20 77  69 6c 6c 20
  63 61 75 73  65 20 61 20  73 79 6e 74  61 78 20 65
  72 72 6f 72  a0 00 00


# Server responds with failure
Server: FAILURE { &quot;code&quot;: &quot;Neo.ClientError.Statement.SyntaxError&quot;,
                  &quot;message&quot;: &quot;Invalid input 'T': expected &lt;init&gt; (line 1, column 1 (offset: 0))
                          &quot;This will cause a syntax error&quot;
                           ^&quot;}

  00 9E B1 7F  A2 84 63 6F  64 65 D0 25  4E 65 6F 2E
  43 6C 69 65  6E 74 45 72  72 6F 72 2E  53 74 61 74
  65 6D 65 6E  74 2E 53 79  6E 74 61 78  45 72 72 6F
  72 87 6D 65  73 73 61 67  65 D0 65 49  6E 76 61 6C
  69 64 20 69  6E 70 75 74  20 27 54 27  3A 20 65 78
  70 65 63 74  65 64 20 3C  69 6E 69 74  3E 20 28 6C
  69 6E 65 20  31 2C 20 63  6F 6C 75 6D  6E 20 31 20
  28 6F 66 66  73 65 74 3A  20 30 29 29  0A 22 54 68
  69 73 20 77  69 6C 6C 20  63 61 75 73  65 20 61 20
  73 79 6E 74  61 78 20 65  72 72 6F 72  22 0A 20 5E
  00 00

# Further requests are ignored
Client: PULL_ALL

  00 02 b0 3f 00 00

Server: IGNORED

  00 02 b0 7e 00 00


# Until the error is acknowledged
Client: RESET

  00 02 b0 0f 00 00

Server: SUCCESS {}

  00 03 b1 70  a0 00 00


# Server is now ready for new statements
Client: RUN &quot;RETURN 1 AS num&quot; {}

  00 13 b2 10  8f 52 45 54  55 52 4e 20  31 20 41 53
  20 6e 75 6d  a0 00 00

Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

  00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
  6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
  62 6C 65 5F  61 66 74 65  72 0C 00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-ack-failure"><a class="anchor" href="#examples-ack-failure"></a>Error handling with ACK_FAILURE</h3>
<div class="paragraph">
<p>This illustrates how to handle errors with <code>ACK_FAILURE</code>.
<code>ACK_FAILURE</code> will not roll back transactions or interrupt messages ahead in line.
Instead, it only clears the error state and moves the session either to <code>IDLE</code> or to <code>IN_TRANSACTION</code>.</p>
</div>
<div class="paragraph">
<p>This is helpful, because it means you always have to run "ROLLBACK" to roll back an open transaction.
For some use cases, that helps minimize complexity, because it cuts down the number of error recovery paths.</p>
</div>
<div class="listingblock">
<div class="title">Error handling with ACK_FAILURE</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00


# We explicitly create a transaction
Client: RUN &quot;BEGIN&quot; {}

  00 09 B2 10  85 42 45 47  49 4E A0 00  00

Client: PULL_ALL

  00 02 B0 3F  00 00

Server: SUCCESS { &quot;fields&quot;: [], &quot;result_available_after&quot;: 12 }

  00 24 B1 70  A2 86 66 69  65 6C 64 73  90 D0 16 72
  65 73 75 6C  74 5F 61 76  61 69 6C 61  62 6C 65 5F
  61 66 74 65  72 0C 00 00

Server: SUCCESS {}

  00 03 B1 70  A0 00 00


# And then send a message with a syntax error
Client: RUN &quot;This will cause a syntax error&quot; {}

  00 23 b2 10  d0 1e 54 68  69 73 20 77  69 6c 6c 20
  63 61 75 73  65 20 61 20  73 79 6e 74  61 78 20 65
  72 72 6f 72  a0 00 00


# Server responds with failure
Server: FAILURE { &quot;code&quot;: &quot;Neo.ClientError.Statement.SyntaxError&quot;,
                  &quot;message&quot;: &quot;Invalid input 'T': expected &lt;init&gt; (line 1, column 1 (offset: 0))
                          &quot;This will cause a syntax error&quot;
                           ^&quot;}

  00 9E B1 7F  A2 84 63 6F  64 65 D0 25  4E 65 6F 2E
  43 6C 69 65  6E 74 45 72  72 6F 72 2E  53 74 61 74
  65 6D 65 6E  74 2E 53 79  6E 74 61 78  45 72 72 6F
  72 87 6D 65  73 73 61 67  65 D0 65 49  6E 76 61 6C
  69 64 20 69  6E 70 75 74  20 27 54 27  3A 20 65 78
  70 65 63 74  65 64 20 3C  69 6E 69 74  3E 20 28 6C
  69 6E 65 20  31 2C 20 63  6F 6C 75 6D  6E 20 31 20
  28 6F 66 66  73 65 74 3A  20 30 29 29  0A 22 54 68
  69 73 20 77  69 6C 6C 20  63 61 75 73  65 20 61 20
  73 79 6E 74  61 78 20 65  72 72 6F 72  22 0A 20 5E
  00 00

# Further requests are ignored
Client: PULL_ALL

  00 02 b0 3f 00 00

Server: IGNORED

  00 02 b0 7e 00 00


# Until the error is acknowledged
Client: ACK_FAILURE

  00 02 B0 0E  00 00

Server: SUCCESS {}

  00 03 b1 70  a0 00 00


# The transaction remains in place, and can be rolled back
Client: RUN &quot;ROLLBACK&quot; {}

  00 0C B2 10  88 52 4F 4C  4C 42 41 43  4B A0 00 00

Server: SUCCESS { &quot;fields&quot;: [], &quot;result_available_after&quot;: 12 }

  00 24 B1 70  A2 86 66 69  65 6C 64 73  90 D0 16 72
  65 73 75 6C  74 5F 61 76  61 69 6C 61  62 6C 65 5F
  61 66 74 65  72 0C 00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="accessing_basic_result_metadata"><a class="anchor" href="#accessing_basic_result_metadata"></a>Accessing basic result metadata</h3>
<div class="paragraph">
<p>If your statement performs changes to the graph or the schema, the <code>SUCCESS</code> message at the end of the result stream will contain statistics describing a summary of the changes.
It will also always contain a description of the type of statement ran - <code>read</code> (<code>r</code>),  <code>write</code> (<code>w</code>), <code>read/write</code> (<code>rw</code>) or <code>schema write</code> (<code>s</code>).</p>
</div>
<div class="listingblock">
<div class="title">Basic metadata</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

# Running a read-only statement will not return any statistics
Client: RUN &quot;RETURN 1 AS num&quot; {}

  00 13 B2 10  8F 52 45 54  55 52 4E 20  31 20 41 53
  20 6E 75 6D  A0 00 00

Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

  00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
  6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
  62 6C 65 5F  61 66 74 65  72 0C 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

Server: RECORD [1]

  00 04 b1 71  91 01 00 00

Server: SUCCESS { &quot;type&quot;: &quot;r&quot;, &quot;result_consumed_after&quot;: 12 }

 00 22 B1 70  A2 84 74 79  70 65 81 72  D0 15 72 65
 73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
 74 65 72 0C  00 00

# Updating queries will return statistics that summarize all executed updates
Client: RUN &quot;CREATE ()&quot; {}

  00 0D B2 10  89 43 52 45  41 54 45 20  28 29 A0 00
  00

Server: SUCCESS { &quot;fields&quot;: [], &quot;result_available_after&quot;: 12 }

  00 24 B1 70  A2 86 66 69  65 6C 64 73  90 D0 16 72
  65 73 75 6C  74 5F 61 76  61 69 6C 61  62 6C 65 5F
  61 66 74 65  72 0C 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

Server: SUCCESS {
          &quot;type&quot;: &quot;w&quot;,
          &quot;stats&quot;: { &quot;nodes-created&quot;: 1 },
          &quot;result_consumed_after&quot;: 12
        }

  00 38 B1 70  A3 84 74 79  70 65 81 77  85 73 74 61
  74 73 A1 8D  6E 6F 64 65  73 2D 63 72  65 61 74 65
  64 01 D0 15  72 65 73 75  6C 74 5F 63  6F 6E 73 75
  6D 65 64 5F  61 66 74 65  72 0C 00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="explaining_and_profiling_a_query"><a class="anchor" href="#explaining_and_profiling_a_query"></a>Explaining and profiling a query</h3>
<div class="paragraph">
<p>Profiling and query explanation is a mechanism of the underlying query engine, meaning there is no explicit protocol mechanism to trigger these.
Instead, profiling is triggered by prefixing your query with <code>PROFILE</code>, and explaining is triggered by prefixing your query with <code>EXPLAIN</code>.
The resulting query plan is returned at the end of the result stream, with the profiling information embedded if you ran <code>PROFILE</code>.</p>
</div>
<div class="listingblock">
<div class="title">Profile query</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

# Explaining the query will not execute it, so it returns an empty result and the query plan
Client: RUN &quot;EXPLAIN RETURN 1 AS num&quot; {}

  00 1C B2 10  D0 17 45 58  50 4C 41 49  4E 20 52 45
  54 55 52 4E  20 31 20 41  53 20 6E 75  6D A0 00 00

Server: SUCCESS { &quot;fields&quot;: [], &quot;result_available_after&quot;: 12 }

  00 24 B1 70  A2 86 66 69  65 6C 64 73  90 D0 16 72
  65 73 75 6C  74 5F 61 76  61 69 6C 61  62 6C 65 5F
  61 66 74 65  72 0C 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

Server: SUCCESS {
          &quot;type&quot;: &quot;r&quot;,
          &quot;result_consumed_after&quot;: 12,
          &quot;plan&quot;: {
            &quot;args&quot;: {
              &quot;runtime-impl&quot;: &quot;INTERPRETED&quot;,
              &quot;planner-impl&quot;: &quot;IDP&quot;,
              &quot;version&quot;: &quot;CYPHER 3.1&quot;,
              &quot;KeyNames&quot;: &quot;num&quot;,
              &quot;EstimatedRows&quot;: 1.0,
              &quot;planner&quot;: &quot;COST&quot;,
              &quot;runtime&quot;: &quot;INTERPRETED&quot;
            },
            &quot;children&quot;: [{
              &quot;args&quot;: {
                &quot;LegacyExpression&quot;: &quot;{  AUTOINT0}&quot;,
                &quot;EstimatedRows&quot;: 1.0},
              &quot;children&quot;: [],
              &quot;identifiers&quot;: [&quot;num&quot;],
              &quot;operatorType&quot;: &quot;Projection&quot;
            }],
            &quot;identifiers&quot;: [&quot;num&quot;],
            &quot;operatorType&quot;: &quot;ProduceResults&quot;
          }
        }

  01 57 B1 70  A3 84 74 79  70 65 81 72  D0 15 72 65
  73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
  74 65 72 0C  84 70 6C 61  6E A4 84 61  72 67 73 A7
  8C 72 75 6E  74 69 6D 65  2D 69 6D 70  6C 8B 49 4E
  54 45 52 50  52 45 54 45  44 8C 70 6C  61 6E 6E 65
  72 2D 69 6D  70 6C 83 49  44 50 87 76  65 72 73 69
  6F 6E 8A 43  59 50 48 45  52 20 33 2E  31 88 4B 65
  79 4E 61 6D  65 73 83 6E  75 6D 8D 45  73 74 69 6D
  61 74 65 64  52 6F 77 73  C1 3F F0 00  00 00 00 00
  00 87 70 6C  61 6E 6E 65  72 84 43 4F  53 54 87 72
  75 6E 74 69  6D 65 8B 49  4E 54 45 52  50 52 45 54
  45 44 88 63  68 69 6C 64  72 65 6E 91  A4 84 61 72
  67 73 A2 D0  10 4C 65 67  61 63 79 45  78 70 72 65
  73 73 69 6F  6E 8C 7B 20  20 41 55 54  4F 49 4E 54
  30 7D 8D 45  73 74 69 6D  61 74 65 64  52 6F 77 73
  C1 3F F0 00  00 00 00 00  00 88 63 68  69 6C 64 72
  65 6E 90 8B  69 64 65 6E  74 69 66 69  65 72 73 91
  83 6E 75 6D  8C 6F 70 65  72 61 74 6F  72 54 79 70
  65 8A 50 72  6F 6A 65 63  74 69 6F 6E  8B 69 64 65
  6E 74 69 66  69 65 72 73  91 83 6E 75  6D 8C 6F 70
  65 72 61 74  6F 72 54 79  70 65 8E 50  72 6F 64 75
  63 65 52 65  73 75 6C 74  73 00 00


# Profiling the query will execute it, and the returned plan now includes the number of rows emitted from
# each part of the plan, as well as the number of database primitive operations that were executed.
Client: RUN &quot;PROFILE RETURN 1 AS num&quot; {}

  00 1C B2 10  D0 17 50 52  4F 46 49 4C  45 20 52 45
  54 55 52 4E  20 31 20 41  53 20 6E 75  6D A0 00 00

Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

   00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
   6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
   62 6C 65 5F  61 66 74 65  72 0C 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

Server: RECORD [1]

  00 04 b1 71  91 01 00 00

# Notice how this time, the response includes &quot;profile&quot; instead of &quot;plan&quot;, which is a Plan tree with
# additional 'DbHits' and 'Rows' metrics in the plan description:
Server: SUCCESS {
          &quot;type&quot;: &quot;r&quot;,
          &quot;result_consumed_after&quot;: 12,
          &quot;profile&quot;: {
            &quot;args&quot;: {
              &quot;planner-impl&quot;: &quot;IDP&quot;,
              &quot;KeyNames&quot;:&quot;num&quot;,
              &quot;runtime&quot;:&quot;INTERPRETED&quot;,
              &quot;runtime-impl&quot;:&quot;INTERPRETED&quot;,
              &quot;version&quot;:&quot;CYPHER 3.1&quot;,
              &quot;EstimatedRows&quot;:1.0,
              &quot;planner&quot;:&quot;COST&quot;,
              &quot;DbHits&quot;:0,
              &quot;Rows&quot;:1
            },
            &quot;operatorType&quot;:&quot;ProduceResults&quot;,
            &quot;rows&quot;:1,
            &quot;children&quot;: [
              {
                &quot;args&quot;: {
                  &quot;LegacyExpression&quot;:&quot;{  AUTOINT0}&quot;,
                  &quot;EstimatedRows&quot;:1.0,
                  &quot;DbHits&quot;:0,
                  &quot;Rows&quot;:1
                },
                &quot;operatorType&quot;:&quot;Projection&quot;,
                &quot;rows&quot;:1,
                &quot;children&quot;:[],
                &quot;dbHits&quot;:0,
                &quot;identifiers&quot;:[&quot;num&quot;]
              }
            ],
            &quot;dbHits&quot;:0,
            &quot;identifiers&quot;:[&quot;num&quot;]
          }
        }

  01 92 B1 70  A3 84 74 79  70 65 81 72  D0 15 72 65
  73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
  74 65 72 0C  87 70 72 6F  66 69 6C 65  A6 84 61 72
  67 73 A9 8C  70 6C 61 6E  6E 65 72 2D  69 6D 70 6C
  83 49 44 50  88 4B 65 79  4E 61 6D 65  73 83 6E 75
  6D 87 72 75  6E 74 69 6D  65 8B 49 4E  54 45 52 50
  52 45 54 45  44 8C 72 75  6E 74 69 6D  65 2D 69 6D
  70 6C 8B 49  4E 54 45 52  50 52 45 54  45 44 87 76
  65 72 73 69  6F 6E 8A 43  59 50 48 45  52 20 33 2E
  31 8D 45 73  74 69 6D 61  74 65 64 52  6F 77 73 C1
  3F F0 00 00  00 00 00 00  87 70 6C 61  6E 6E 65 72
  84 43 4F 53  54 86 44 62  48 69 74 73  00 84 52 6F
  77 73 01 8C  6F 70 65 72  61 74 6F 72  54 79 70 65
  8E 50 72 6F  64 75 63 65  52 65 73 75  6C 74 73 84
  72 6F 77 73  01 88 63 68  69 6C 64 72  65 6E 91 A6
  84 61 72 67  73 A4 D0 10  4C 65 67 61  63 79 45 78
  70 72 65 73  73 69 6F 6E  8C 7B 20 20  41 55 54 4F
  49 4E 54 30  7D 8D 45 73  74 69 6D 61  74 65 64 52
  6F 77 73 C1  3F F0 00 00  00 00 00 00  86 44 62 48
  69 74 73 00  84 52 6F 77  73 01 8C 6F  70 65 72 61
  74 6F 72 54  79 70 65 8A  50 72 6F 6A  65 63 74 69
  6F 6E 84 72  6F 77 73 01  88 63 68 69  6C 64 72 65
  6E 90 86 64  62 48 69 74  73 00 8B 69  64 65 6E 74
  69 66 69 65  72 73 91 83  6E 75 6D 86  64 62 48 69
  74 73 00 8B  69 64 65 6E  74 69 66 69  65 72 73 91
  83 6E 75 6D  00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="accessing_notifications"><a class="anchor" href="#accessing_notifications"></a>Accessing notifications</h3>
<div class="paragraph">
<p>When Neo4j executes a statement it may include notifications for the user.
These notifications can be warnings about problematic statements or other valuable information for a client.
Notifications are only included when using <code>EXPLAIN</code>.</p>
</div>
<div class="listingblock">
<div class="title">Notifications</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

# Sending a statement that would result in notifications
Client: RUN &quot;EXPLAIN MATCH (n), (m) RETURN n, m&quot; {}
  00 27 B2 10  D0 22 45 58  50 4C 41 49  4E 20 4D 41
  54 43 48 20  28 6E 29 2C  20 28 6D 29  20 52 45 54
  55 52 4E 20  6E 2C 20 6D  A0 00 00

Server: SUCCESS { &quot;fields&quot;: [], &quot;result_available_after&quot;: 12 }

  00 24 B1 70  A2 86 66 69  65 6C 64 73  90 D0 16 72
  65 73 75 6C  74 5F 61 76  61 69 6C 61  62 6C 65 5F
  61 66 74 65  72 0C 00 00

Client: PULL_ALL

  00 02 B0 3F  00 00

# Notifications are included in the response and each of them consists of `code`, `title` and `description`. A notification might also include `position` to indicate where the notification arises if it is applicable.
Server: SUCCESS {
          &quot;type&quot;: &quot;r&quot;,
          &quot;result_consumed_after&quot;: 12,
          &quot;plan&quot;: {
            &quot;args&quot;: {
              &quot;runtime-impl&quot;: &quot;INTERPRETED&quot;,
              &quot;planner-impl&quot;: &quot;IDP&quot;,
              &quot;version&quot;: &quot;CYPHER 3.1&quot;,
              &quot;KeyNames&quot;: &quot;n, m&quot;,
              &quot;EstimatedRows&quot;: 1.0,
              &quot;planner&quot;: &quot;COST&quot;,
              &quot;runtime&quot;: &quot;INTERPRETED&quot;
            },
            &quot;children&quot;: [{
              &quot;args&quot;: {&quot;EstimatedRows&quot;: 1.0},
              &quot;children&quot;: [{
                &quot;args&quot;: {&quot;EstimatedRows&quot;: 1.0},
                &quot;children&quot;: [],
                &quot;identifiers&quot;: [&quot;n&quot;],
                &quot;operatorType&quot;: &quot;AllNodesScan&quot;
                },{
                &quot;args&quot;: {&quot;EstimatedRows&quot;: 1.0},
                &quot;children&quot;: [],
                &quot;identifiers&quot;: [&quot;m&quot;],
                &quot;operatorType&quot;: &quot;AllNodesScan&quot;
              }],
              &quot;identifiers&quot;: [&quot;m&quot;, &quot;n&quot;],
              &quot;operatorType&quot;: &quot;CartesianProduct&quot;
            }],
            &quot;identifiers&quot;: [&quot;m&quot;, &quot;n&quot;],
            &quot;operatorType&quot;: &quot;ProduceResults&quot;
          },
          &quot;notifications&quot;: [{
            &quot;severity&quot;: &quot;WARNING&quot;,
            &quot;title&quot;: &quot;This query builds a cartesian product between disconnected patterns.&quot;,
            &quot;code&quot;: &quot;Neo.ClientNotification.Statement.CartesianProductWarning&quot;,
            &quot;description&quot;: &quot;If a part of a query contains multiple disconnected patterns, this will build a cartesian product between all those parts. This may produce a large amount of data and slow down query processing. While occasionally intended, it may often be possible to reformulate the query that avoids the use of this cross product, perhaps by adding a relationship between the different parts or by using OPTIONAL MATCH (identifier is: (m))&quot;,
            &quot;position&quot;: {
              &quot;offset&quot;: 0, &quot;column&quot;: 1, &quot;line&quot;: 1
            }
          }]
        }

  04 66 B1 70  A4 84 74 79  70 65 81 72  D0 15 72 65
  73 75 6C 74  5F 63 6F 6E  73 75 6D 65  64 5F 61 66
  74 65 72 0C  84 70 6C 61  6E A4 84 61  72 67 73 A7
  8C 72 75 6E  74 69 6D 65  2D 69 6D 70  6C 8B 49 4E
  54 45 52 50  52 45 54 45  44 8C 70 6C  61 6E 6E 65
  72 2D 69 6D  70 6C 83 49  44 50 87 76  65 72 73 69
  6F 6E 8A 43  59 50 48 45  52 20 33 2E  31 88 4B 65
  79 4E 61 6D  65 73 84 6E  2C 20 6D 8D  45 73 74 69
  6D 61 74 65  64 52 6F 77  73 C1 3F F0  00 00 00 00
  00 00 87 70  6C 61 6E 6E  65 72 84 43  4F 53 54 87
  72 75 6E 74  69 6D 65 8B  49 4E 54 45  52 50 52 45
  54 45 44 88  63 68 69 6C  64 72 65 6E  91 A4 84 61
  72 67 73 A1  8D 45 73 74  69 6D 61 74  65 64 52 6F
  77 73 C1 3F  F0 00 00 00  00 00 00 88  63 68 69 6C
  64 72 65 6E  92 A4 84 61  72 67 73 A1  8D 45 73 74
  69 6D 61 74  65 64 52 6F  77 73 C1 3F  F0 00 00 00
  00 00 00 88  63 68 69 6C  64 72 65 6E  90 8B 69 64
  65 6E 74 69  66 69 65 72  73 91 81 6E  8C 6F 70 65
  72 61 74 6F  72 54 79 70  65 8C 41 6C  6C 4E 6F 64
  65 73 53 63  61 6E A4 84  61 72 67 73  A1 8D 45 73
  74 69 6D 61  74 65 64 52  6F 77 73 C1  3F F0 00 00
  00 00 00 00  88 63 68 69  6C 64 72 65  6E 90 8B 69
  64 65 6E 74  69 66 69 65  72 73 91 81  6D 8C 6F 70
  65 72 61 74  6F 72 54 79  70 65 8C 41  6C 6C 4E 6F
  64 65 73 53  63 61 6E 8B  69 64 65 6E  74 69 66 69
  65 72 73 92  81 6D 81 6E  8C 6F 70 65  72 61 74 6F
  72 54 79 70  65 D0 10 43  61 72 74 65  73 69 61 6E
  50 72 6F 64  75 63 74 8B  69 64 65 6E  74 69 66 69
  65 72 73 92  81 6D 81 6E  8C 6F 70 65  72 61 74 6F
  72 54 79 70  65 8E 50 72  6F 64 75 63  65 52 65 73
  75 6C 74 73  8D 6E 6F 74  69 66 69 63  61 74 69 6F
  6E 73 91 A5  88 73 65 76  65 72 69 74  79 87 57 41
  52 4E 49 4E  47 85 74 69  74 6C 65 D0  44 54 68 69
  73 20 71 75  65 72 79 20  62 75 69 6C  64 73 20 61
  20 63 61 72  74 65 73 69  61 6E 20 70  72 6F 64 75
  63 74 20 62  65 74 77 65  65 6E 20 64  69 73 63 6F
  6E 6E 65 63  74 65 64 20  70 61 74 74  65 72 6E 73
  2E 84 63 6F  64 65 D0 38  4E 65 6F 2E  43 6C 69 65
  6E 74 4E 6F  74 69 66 69  63 61 74 69  6F 6E 2E 53
  74 61 74 65  6D 65 6E 74  2E 43 61 72  74 65 73 69
  61 6E 50 72  6F 64 75 63  74 57 61 72  6E 69 6E 67
  8B 64 65 73  63 72 69 70  74 69 6F 6E  D1 01 A9 49
  66 20 61 20  70 61 72 74  20 6F 66 20  61 20 71 75
  65 72 79 20  63 6F 6E 74  61 69 6E 73  20 6D 75 6C
  74 69 70 6C  65 20 64 69  73 63 6F 6E  6E 65 63 74
  65 64 20 70  61 74 74 65  72 6E 73 2C  20 74 68 69
  73 20 77 69  6C 6C 20 62  75 69 6C 64  20 61 20 63
  61 72 74 65  73 69 61 6E  20 70 72 6F  64 75 63 74
  20 62 65 74  77 65 65 6E  20 61 6C 6C  20 74 68 6F
  73 65 20 70  61 72 74 73  2E 20 54 68  69 73 20 6D
  61 79 20 70  72 6F 64 75  63 65 20 61  20 6C 61 72
  67 65 20 61  6D 6F 75 6E  74 20 6F 66  20 64 61 74
  61 20 61 6E  64 20 73 6C  6F 77 20 64  6F 77 6E 20
  71 75 65 72  79 20 70 72  6F 63 65 73  73 69 6E 67
  2E 20 57 68  69 6C 65 20  6F 63 63 61  73 69 6F 6E
  61 6C 6C 79  20 69 6E 74  65 6E 64 65  64 2C 20 69
  74 20 6D 61  79 20 6F 66  74 65 6E 20  62 65 20 70
  6F 73 73 69  62 6C 65 20  74 6F 20 72  65 66 6F 72
  6D 75 6C 61  74 65 20 74  68 65 20 71  75 65 72 79
  20 74 68 61  74 20 61 76  6F 69 64 73  20 74 68 65
  20 75 73 65  20 6F 66 20  74 68 69 73  20 63 72 6F
  73 73 20 70  72 6F 64 75  63 74 2C 20  70 65 72 68
  61 70 73 20  62 79 20 61  64 64 69 6E  67 20 61 20
  72 65 6C 61  74 69 6F 6E  73 68 69 70  20 62 65 74
  77 65 65 6E  20 74 68 65  20 64 69 66  66 65 72 65
  6E 74 20 70  61 72 74 73  20 6F 72 20  62 79 20 75
  73 69 6E 67  20 4F 50 54  49 4F 4E 41  4C 20 4D 41
  54 43 48 20  28 69 64 65  6E 74 69 66  69 65 72 20
  69 73 3A 20  28 6D 29 29  88 70 6F 73  69 74 69 6F
  6E A3 86 6F  66 66 73 65  74 00 86 63  6F 6C 75 6D
  6E 01 84 6C  69 6E 65 01  00 00</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resetting_the_session"><a class="anchor" href="#resetting_the_session"></a>Resetting the session</h3>
<div class="paragraph">
<p>This illustrates how to reset the session to a "clean" state.</p>
</div>
<div class="listingblock">
<div class="title">Resetting</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bolt_exchange"># Handshake
Client: &lt;connect&gt;
Client: 60 60 B0 17
Client: 00 00 00 01  00 00 00 00  00 00 00 00  00 00 00 00
Server: 00 00 00 01

Client: INIT &quot;MyClient/1.0&quot; { &quot;scheme&quot;: &quot;basic&quot;, &quot;principal&quot;: &quot;neo4j&quot;, &quot;credentials&quot;: &quot;secret&quot;}

  00 40 B2 01  8C 4D 79 43  6C 69 65 6E  74 2F 31 2E
  30 A3 86 73  63 68 65 6D  65 85 62 61  73 69 63 89
  70 72 69 6E  63 69 70 61  6C 85 6E 65  6F 34 6A 8B
  63 72 65 64  65 6E 74 69  61 6C 73 86  73 65 63 72
  65 74 00 00

Server: SUCCESS { &quot;server&quot;: &quot;Neo4j/3.1.0&quot; }

  00 16 B1 70  A1 86 73 65  72 76 65 72  8B 4E 65 6F
  34 6A 2F 33  2E 31 2E 30  00 00

# Batch of messages
Client: RUN &quot;RETURN 1 AS num&quot; {}

  00 13 b2 10  8f 52 45 54  55 52 4e 20  31 20 41 53
  20 6e 75 6d  a0 00 00

# Server responses
Server: SUCCESS { &quot;fields&quot;: [&quot;num&quot;], &quot;result_available_after&quot;: 12 }

  00 28 B1 70  A2 86 66 69  65 6C 64 73  91 83 6E 75
  6D D0 16 72  65 73 75 6C  74 5F 61 76  61 69 6C 61
  62 6C 65 5F  61 66 74 65  72 0C 00 00

Client: RESET {}

  00 02 b0 0f  00 00

Server: SUCCESS {}

  00 03 b1 70  a0 00 00</code></pre>
</div>
</div>
</div>
</div>
</div>
    </div>
  </div>
</section>

<footer class="row">
  <div class="large-12 columns">
    <hr/>
    <div class="row">
      <div class="large-12 columns">
        <p>Licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons 3.0 Attribution-ShareAlike</a>.</p>
        <p><a href="https://github.com/neo4j/neo4j/tree/3.0.6/manual/bolt/src/docs/dev">Originally authored</a> by <a href="https://neo4j.com">Neo Technology, Inc.</a>, with modifications to original source for publishing and clarity.</p>
      </div>
    </div>
  </div>
</footer>

<script src="/js/vendor/jquery.js"></script>
<script src="/js/foundation.min.js"></script>
<script>
  $(document).foundation();
</script>
<script src="/js/vendor/jquery.js"></script>
<script src="/js/foundation/foundation.js"></script>
<script>
  $(document).foundation();
  var doc = document.documentElement;
  doc.setAttribute('data-useragent', navigator.userAgent);
</script>
</body>
</html>
